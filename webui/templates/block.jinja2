{% extends "base.jinja2" %}

{% block title %}Block {{ block.header.metadata.height }} - Haruka's Aleo Explorer{% endblock %}

{% block head %}
    <style>

        #data {
            margin: 20px 4px;
        }

        .data-line {
            padding: 10px 0;
            border-bottom: 1px solid #ccc;
        }

        .data-line-value {
            overflow-wrap: break-word;
        }

        .tooltip {
            max-width: 250px;
        }

        .text-alert {
            color: #cc4b37;
        }

    </style>
{% endblock %}

{% block content %}

    <div class="content">

        <div id="header">
            <h3>Block {{ block.header.metadata.height }}</h3>
        </div>

        <div id="data">
            <!-- Keeping this verbose but need a way to simplify it -->
            <!-- Looks like web components is the way to go, but I don't know how now-->
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Height
                </div>
                <div class="cell auto data-line-value">
                    {{ block.header.metadata.height }}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Epoch
                </div>
                <div class="cell auto data-line-value">
                    {{ block.header.metadata.height // 256 }}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Timestamp
                </div>
                <div class="cell auto data-line-value">
                    {{ block.header.metadata.timestamp | format_time | safe }}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Confirmations
                </div>
                <div class="cell auto data-line-value">
                    {{ confirmations }}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Coinbase target
                </div>
                <div class="cell auto data-line-value">
                    {{ block.header.metadata.coinbase_target }}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Proof target
                </div>
                <div class="cell auto data-line-value">
                    {{ block.header.metadata.proof_target }}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Coinbase reward
                </div>
                <div class="cell auto data-line-value">
                    {% if coinbase_reward %}{{ coinbase_reward | format_aleo_credit }}{% else %}-{% endif %}
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Block hash
                </div>
                <div class="cell auto data-line-value">
                    <span class="mono">{{ block.block_hash }}</span>
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Previous block hash
                </div>
                <div class="cell auto data-line-value">
                    <a href="/block?bh={{ block.previous_hash }}"><span class="mono">{{ block.previous_hash }}</span></a>
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Previous state root
                </div>
                <div class="cell auto data-line-value">
                    <span class="mono">{{ block.header.previous_state_root }}</span>
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Transactions root
                </div>
                <div class="cell auto data-line-value">
                    <span class="mono">{{ block.header.transactions_root }}</span>
                </div>
            </div>
            <div class="data-line grid-x grid-padding-x">
                <div class="cell small-3 block-data-line-label">
                    Coinbase accumulator point
                </div>
                <div class="cell auto data-line-value">
                    <span class="mono">{{ block.header.coinbase_accumulator_point }}</span>
                </div>
            </div>
        </div>

        <div id="transactions">
            <h4>Transactions</h4>
            <table id="transactions-table" class="unstriped">
                <thead>
                <tr>
                    <td>Transaction ID</td>
                    <td>Type</td>
                    <td>Transitions</td>
                </tr>
                </thead>
                <tbody>
                {% for tx in transactions %}
                    <tr>
                        <td class="mono"><a href="/transaction?id={{ tx.tx_id }}">{{ tx.tx_id }}</a></td>
                        <td>{{ tx.type }}</td>
                        <td>{{ tx.transitions_count }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

    </div>

{% endblock %}